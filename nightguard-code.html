<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="NightGuard technical spec & code examples" />
    <title>NightGuard â€” Technical Spec & Code</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" />
    <link href="css/styles.css" rel="stylesheet" />
    <style>
      .content-card{ background:#fff; max-width:980px; margin:100px auto 40px; padding:28px; border-radius:12px; box-shadow:0 12px 36px rgba(0,0,0,0.12); font-family: Consolas, "Courier New", monospace; font-size:14px }
      pre{ background:#0f1720; color:#d6f3ff; padding:16px; border-radius:8px; overflow:auto }
      .spec-list{ font-family: "Times New Roman", Times, serif; font-size:16px }
    </style>
  </head>
  <body id="page-top">
    <nav class="navbar navbar-expand-lg bg-secondary text-uppercase fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand" href="index.html">Prajnapuri Design</a>
        <button class="navbar-toggler text-uppercase font-weight-bold bg-primary text-white rounded" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive">
          Menu <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link px-lg-3" href="index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link px-lg-3" href="project.html">Project</a></li>
            <li class="nav-item"><a class="nav-link px-lg-3" href="sumit.html">Sumit</a></li>
            <li class="nav-item"><a class="nav-link px-lg-3" href="shrinivas.html">Shrinivas</a></li>
            <li class="nav-item"><a class="nav-link px-lg-3" href="manjunath.html">Manjunath</a></li>
            <li class="nav-item"><a class="nav-link px-lg-3" href="samarth.html">Samarth</a></li>
          </ul>
                    <!-- Theme toggle -->
                    <div class="d-flex align-items-center ms-3">
                      <button id="themeToggle" class="btn-theme-toggle" aria-label="Toggle dark mode">ðŸŒ™</button>
                    </div>
        </div>
      </div>
    </nav>

    <header class="masthead masthead-small text-white text-center"></header>

    <section class="page-section" style="padding-top:40px; background:#d6e9f5; min-height:60vh;">
      <div class="content-card">
        <h2 style="font-family: 'Montserrat', sans-serif;">NightGuard â€” Technical Spec &amp; Example Code</h2>

        <h3 style="font-family: 'Times New Roman', serif;">1) Data model (example JSON)</h3>
        <pre><code>{
  "trip": {
    "id": "trip_12345",
    "user_id": "user_987",
    "driver": { "id": "drv_42", "name": "Asha", "photo": "url" },
    "vehicle": { "plate": "KA01XX1234", "type": "RSV" },
    "route": { "start": {"lat": 12.9, "lng": 77.6}, "end": {"lat": 12.95, "lng": 77.62} },
    "eta_safe_arrival": "2025-12-13T01:23:00Z",
    "status": "en_route"
  }
}</code></pre>

        <h3 style="font-family: 'Times New Roman', serif;">2) Silent S.O.S. (example client JS snippet)</h3>
        <pre><code>// POST current GPS to city security endpoint
async function sendSilentSos(tripId, userId, gps) {
  const payload = { tripId, userId, gps, timestamp: new Date().toISOString() };
  await fetch('/api/nightguard/silent-sos', {
    method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload)
  });
}

// Example usage:
// sendSilentSos('trip_12345','user_987',{lat:12.92,lng:77.61});
</code></pre>

        <h3 style="font-family: 'Times New Roman', serif;">3) ETSA calculation (pseudocode)</h3>
        <pre><code>// ETSA = Estimated Time of Safe Arrival
function calculateETSA(currentLocation, routePoints, safetyFactor) {
  // sum segment times (considering speed and safetyFactor for detours)
  let timeMs = 0;
  for (let i=0;i<routePoints.length-1;i++){
    timeMs += segmentTime(routePoints[i],routePoints[i+1]) * safetyFactor;
  }
  return new Date(Date.now() + timeMs).toISOString();
}
</code></pre>

        <h3 style="font-family: 'Times New Roman', serif;">4) Deployment notes</h3>
        <ul class="spec-list">
          <li>Secure endpoints (mutual TLS / OAuth2) for city security integration.</li>
          <li>Store minimal location history and respect local privacy rules.</li>
          <li>Run pilot with manual monitoring and iterate detection thresholds.</li>
        </ul>

        <div style="margin-top:18px; display:flex; gap:12px; flex-wrap:wrap">
          <a class="btn btn-primary" href="night-time-safe-travel-services.html">Back to NightGuard</a>
          <a class="btn btn-outline-secondary" href="shrinivas.html">Back to ideas</a>
        </div>
      </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/scripts.js"></script>
  </body>
</html>
